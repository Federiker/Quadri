var Magnifier=function(n,t){"use strict";var f=t||{},s=null,i={x:0,y:0,w:0,h:0,lensW:0,lensH:0,lensBgX:0,lensBgY:0,largeW:0,largeH:0,largeL:0,largeT:0,zoom:2,mode:"outside",largeWrapperId:f.largeWrapper!==undefined?f.largeWrapper.id||null:null,status:0,zoomAttached:!1,zoomable:f.zoomable!==undefined?f.zoomable:!1,onthumbenter:f.onthumbenter!==undefined?f.onthumbenter:null,onthumbmove:f.onthumbmove!==undefined?f.onthumbmove:null,onthumbleave:f.onthumbleave!==undefined?f.onthumbleave:null,onzoom:f.onzoom!==undefined?f.onzoom:null},r={t:0,l:0,x:0,y:0},y=0,p=0,c="",u=null,e=null,tt=f.zoom!==undefined?f.zoom:i.zoom,it=f.mode||i.mode,o={},w=!1,l=0,rt=function(n){var r=[],i=null,f=0,e="",t=0,u=0;if(document.getElementsByClassName)r=document.getElementsByClassName(n);else for(i=document.getElementsByTagName("*"),f=i.length,e=new RegExp("(^|\\s)"+n+"(\\s|$)"),t,u;t<f;t+=1)e.test(i[t].className)&&(r[u]=i[t],u+=1);return r},h=function(n){var t="",i=n.charAt(0),r=null;if((i==="#"||i===".")&&(t=n.substr(1,n.length)),t!=="")switch(i){case"#":r=document.getElementById(t);break;case".":r=rt(t)}return r},ut=function(n,t){var i=document.createElement("div");i.id=t+"-lens";i.className="magnifier-loader";n.parentNode.appendChild(i)},ft=function(){u.style.left=r.l+"px";u.style.top=r.t+"px";u.style.width=i.lensW+"px";u.style.height=i.lensH+"px";u.style.backgroundPosition="-"+i.lensBgX+"px -"+i.lensBgY+"px";e.style.left="-"+i.largeL+"px";e.style.top="-"+i.largeT+"px";e.style.width=i.largeW+"px";e.style.height=i.largeH+"px"},b=function(n,t,i,r){var u=h("#"+n+"-lens"),f=null;o[n].status===1?(f=document.createElement("div"),f.className="magnifier-loader-text",u.className="magnifier-loader hidden",f.appendChild(document.createTextNode("Loading...")),u.appendChild(f)):o[n].status===2&&(u.className="magnifier-lens hidden",u.removeChild(u.childNodes[0]),u.style.background="url("+t.src+") no-repeat 0 0 scroll",i.id=n+"-large",i.style.width=o[n].largeW+"px",i.style.height=o[n].largeH+"px",i.className="magnifier-large hidden",o[n].mode==="inside"?u.appendChild(i):r.appendChild(i));u.style.width=o[n].lensW+"px";u.style.height=o[n].lensH+"px"},a=function(){var n=r.x-i.x,t=r.y-i.y,u=0,f=0;w=n<0||t<0||n>i.w||t>i.h?!1:!0;f=n-i.lensW/2;u=t-i.lensH/2;i.mode!=="inside"&&(n<i.lensW/2&&(f=0),t<i.lensH/2&&(u=0),n-i.w+i.lensW/2>0&&(f=i.w-(i.lensW+2)),t-i.h+i.lensH/2>0&&(u=i.h-(i.lensH+2)));r.l=Math.round(f);r.t=Math.round(u);i.lensBgX=r.l+1;i.lensBgY=r.t+1;i.mode==="inside"?(i.largeL=Math.round(n*(i.zoom-i.lensW/i.w)),i.largeT=Math.round(t*(i.zoom-i.lensH/i.h))):(i.largeL=Math.round(i.lensBgX*i.zoom*(i.largeWrapperW/i.w)),i.largeT=Math.round(i.lensBgY*i.zoom*(i.largeWrapperH/i.h)))},k=function(n){var c=n.wheelDelta>0||n.detail<0?.1:-.1,o=i.onzoom,h=1,t=0,f=0;n.preventDefault&&n.preventDefault();n.returnValue=!1;i.zoom=Math.round((i.zoom+c)*10)/10;i.zoom>=1.1?(i.lensW=Math.round(i.w/i.zoom),i.lensH=Math.round(i.h/i.zoom),i.mode==="inside"?(t=i.w,f=i.h):(t=i.largeWrapperW,f=i.largeWrapperH,h=i.largeWrapperW/i.w),i.largeW=Math.round(i.zoom*t),i.largeH=Math.round(i.zoom*f),a(),ft(),o!==null&&o({thumb:s,lens:u,large:e,x:r.x,y:r.y,zoom:Math.round(i.zoom*h*10)/10,w:i.lensW,h:i.lensH})):i.zoom=1.1},d=function(){i=o[c];u=h("#"+c+"-lens");i.status===2?(u.className="magnifier-lens",i.zoomAttached===!1&&(i.zoomable!==undefined&&i.zoomable===!0&&(n.attach("mousewheel",u,k),window.addEventListener&&u.addEventListener("DOMMouseScroll",function(n){k(n)})),i.zoomAttached=!0),e=h("#"+c+"-large"),e.className="magnifier-large"):i.status===1&&(u.className="magnifier-loader")},g=function(){if(i.status>0){var n=i.onthumbleave;n!==null&&n({thumb:s,lens:u,large:e,x:r.x,y:r.y});u.className.indexOf("hidden")===-1&&(u.className+=" hidden",s.className=i.thumbCssClass,e!==null&&(e.className+=" hidden"))}},nt=function(){if(p!==i.status&&d(),i.status>0){s.className=i.thumbCssClass+" opaque";i.status===1?u.className="magnifier-loader":i.status===2&&(u.className="magnifier-lens",e.className="magnifier-large",e.style.left="-"+i.largeL+"px",e.style.top="-"+i.largeT+"px");u.style.left=r.l+"px";u.style.top=r.t+"px";u.style.backgroundPosition="-"+i.lensBgX+"px -"+i.lensBgY+"px";var n=i.onthumbmove;n!==null&&n({thumb:s,lens:u,large:e,x:r.x,y:r.y})}p=i.status},v=function(n,t){var i=n.getBoundingClientRect(),r=0,u=0;t.x=i.left;t.y=i.top;t.w=Math.round(i.right-t.x);t.h=Math.round(i.bottom-t.y);t.lensW=Math.round(t.w/t.zoom);t.lensH=Math.round(t.h/t.zoom);t.mode==="inside"?(r=t.w,u=t.h):(r=t.largeWrapperW,u=t.largeWrapperH);t.largeW=Math.round(t.zoom*r);t.largeH=Math.round(t.zoom*u)};this.attach=function(n){if(n.thumb===undefined)throw{name:"Magnifier error",message:"Please set thumbnail",toString:function(){return this.name+": "+this.message}};var t=h(n.thumb),i=0;if(t.length!==undefined)for(i;i<t.length;i+=1)n.thumb=t[i],this.set(n);else n.thumb=t,this.set(n)};this.setThumb=function(n){s=n};this.set=function(t){if(o[t.thumb.id]!==undefined)return s=t.thumb,!1;var et=new Image,ft=new Image,f=t.thumb,p=f.id,rt=null,ot=null,w=h("#"+t.largeWrapper)||h("#"+f.getAttribute("data-large-img-wrapper"))||h("#"+i.largeWrapperId),st=t.zoom||f.getAttribute("data-zoom")||tt,k=t.mode||f.getAttribute("data-mode")||it,ht=t.onthumbenter!==undefined?t.onthumbenter:i.onthumbenter,ct=t.onthumbleave!==undefined?t.onthumbleave:i.onthumbleave,lt=t.onthumbmove!==undefined?t.onthumbmove:i.onthumbmove,at=t.onzoom!==undefined?t.onzoom:i.onzoom;if(ot=t.large===undefined?t.thumb.getAttribute("data-large-img-url")!==null?t.thumb.getAttribute("data-large-img-url"):t.thumb.src:t.large,w===null&&k!=="inside")throw{name:"Magnifier error",message:"Please specify large image wrapper DOM element",toString:function(){return this.name+": "+this.message}};t.zoomable!==undefined?rt=t.zoomable:f.getAttribute("data-zoomable")!==null?rt=f.getAttribute("data-zoomable")==="true":i.zoomable!==undefined&&(rt=i.zoomable);f.id===""&&(p=f.id="magnifier-item-"+y,y+=1);ut(f,p);o[p]={zoom:st,mode:k,zoomable:rt,thumbCssClass:f.className,zoomAttached:!1,status:0,largeUrl:ot,largeWrapperId:k==="outside"?w.id:null,largeWrapperW:k==="outside"?w.offsetWidth:null,largeWrapperH:k==="outside"?w.offsetHeight:null,onzoom:at,onthumbenter:ht,onthumbleave:ct,onthumbmove:lt};n.attach("mouseover",f,function(n,t){i.status!==0&&g();c=t.id;s=t;d(t);v(s,i);r.x=n.clientX;r.y=n.clientY;a();nt();var f=i.onthumbenter;f!==null&&f({thumb:s,lens:u,large:e,x:r.x,y:r.y})},!1);n.attach("mousemove",f,function(){l=1});n.attach("load",et,function(){o[p].status=1;v(f,o[p]);b(p);n.attach("load",ft,function(){o[p].status=2;b(p,f,ft,w)});ft.src=o[p].largeUrl});et.src=f.src};n.attach("mousemove",document,function(n){r.x=n.clientX;r.y=n.clientY;a();w===!0?nt():(l!==0&&g(),l=0)},!1);n.attach("scroll",window,function(){s!==null&&v(s,i)})};
//# sourceMappingURL=Magnifier.min.js.map
